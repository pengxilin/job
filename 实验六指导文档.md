# 实验六报告

> 学号：<3225902010>
> 
> 姓名：<陈燕茹>
> 
> 指导老师：<张凯斌>
> 
> 实验日期：<2025-04-17>

## 一、实验目的

- 完成实验五中的L/R页面功能；
- 锻炼课堂所讲授的面向对象分析与设计能力；
- 实践编码能力

## 二、实验内容

- 依托教科书的第9章“数据管理”；
- 回顾实验三与实验四内容；
- 结合《课程指导》

完成本次实验。

## 三、实验要求

- Login/Registration System
  - 本次实验要求完成完整的登录/注册功能
- 基本需求
  - 三个UI Pages
    - L/R Page（实验五已进行）
      - 添加一个“角色”选项
        - 用户
        - 管理员
      - 输对用户名和密码后
        - 用户进入Home Page
        - 管理员进入Management Page
      - 如果登录信息不存在，提示进行“注册”
      - 连续3次输错密码后，关闭整个App
    - Registration Page
      - 引导用户输入注册信息
        - 用户名、性别、邮箱、密码、角色为必选项，其他自行设计
        - 需对用户输入内容进行形式判断，如数据类型等
          - 形式判断错误的，需要引导用户重新输入
      - 点击确认按钮后信息存入SQLite数据库
        - “用户”采用HarmonyOS的built-in加密存储功能
        - “管理员”采用自行加密模块处理后存储
    - Management Page
      - 此为管理员登录成功后可进入的页面
      - 具备“查询”按钮，点击返回整个注册数据库的信息
        - 跳转页面后用列表显示出来
          - 需解密后显示明文
  - 完成用例图和详细类图
    - 其他类型的图不要求
  - 完成编码实现
- 技术要求
  - 不能使用回调函数来完成异步编程，全部使用async/await形式
  - 必须有关键节点的日志输出



## 四、实验步骤

### 1. L/R Page

#### 1.1 截图展示

<img src="登录页面.png" width="200" height="350">
<img src="首次错误.png" width="200" height="350">
<img src="自动关闭.png" width="200" height="350">

#### 1.2 用例图与类图

<img src="Login Use Case Diagram.png">
<img src="Login Class Diagram.png">

#### 1.3 代码实现
LoginPage.ets
```typescript
import { promptAction, router } from '@kit.ArkUI';
import { DatabaseHelper } from '../utils/DatabaseHelper';
import { Logger } from '../utils/Logger';
import app from '@ohos.app.ability.common';
import type { UserData } from '../utils/DatabaseHelper';

/**
 * 登录页面组件
 * 实现用户登录功能，包括：
 * 1. 用户名和密码验证
 * 2. 角色选择（用户/管理员）
 * 3. 登录失败次数限制（3次后锁定）
 * 4. 根据角色跳转到不同页面
 */
@Entry
@Component
struct LoginPage {
  // 用户输入状态管理
  @State username: string = '';
  @State password: string = '';
  @State role: string = 'user';  // 默认为普通用户
  @State errorMessage: string = '';
  @State loginLoading: boolean = false;
  
  // 数据库实例
  @State private dbHelper: DatabaseHelper | null = null;
  private context: app.UIAbilityContext = getContext(this) as app.UIAbilityContext;

  // 页面初始化时连接数据库
  aboutToAppear() {
    this.initializeDatabase();
  }

  // 初始化数据库连接
  private async initializeDatabase() {
    try {
      this.dbHelper = await DatabaseHelper.getInstance();
      const context = getContext(this) as app.Context;
      await this.dbHelper.init(context);
      // 记录数据库初始化成功
      Logger.log('Database initialized successfully');
    } catch (error) {
      // 记录初始化失败
      Logger.error('Database initialization failed:', error as Error);
      promptAction.showToast({ message: '数据库初始化失败' });
    }
  }

  // 处理登录逻辑
  private async handleLogin() {
    // 验证输入完整性
    if (!this.username || !this.password) {
      this.errorMessage = '请输入用户名和密码';
      return;
    }
    if (!this.dbHelper) {
      this.errorMessage = '系统初始化中，请稍后';
      return;
    }

    this.loginLoading = true;
    this.errorMessage = '';
    try {
      // 验证登录信息
      const loginSuccess = await this.dbHelper.verifyLogin(this.username, this.password, this.role);
      if (loginSuccess) {
        // 登录成功，重置失败计数
        this.dbHelper.resetLoginFailure(this.username);
        Logger.log(`User ${this.username} logged in successfully`);
        promptAction.showToast({
          message: `欢迎回来，${this.username}！`,
          duration: 2000
        });

        // 根据角色跳转不同页面
        if (this.role === 'user') {
          await router.pushUrl({
            url: 'pages/HomePage',
            params: { username: this.username }
          });
        } else {
          // 管理员登录成功后询问是否查询数据
          AlertDialog.show({
            title: '管理员登录成功',
            message: '是否查询用户数据？',
            primaryButton: {
              value: '暂不查询',
              action: async () => {
                await router.pushUrl({
                  url: 'pages/ManagementPage',
                  params: {
                    username: this.username,
                    shouldQuery: false
                  }
                });
              }
            },
            secondaryButton: {
              value: '立即查询',
              action: async () => {
                await router.pushUrl({
                  url: 'pages/ManagementPage',
                  params: {
                    username: this.username,
                    shouldQuery: true
                  }
                });
              }
            }
          });
        }
      } else {
        // 登录失败，记录失败次数
        const failCount = this.dbHelper.recordLoginFailure(this.username);
        Logger.warn(`Login failed for ${this.username}, attempt ${failCount}`);
        
        // 检查是否达到最大失败次数
        if (failCount >= 3) {
          // 重要：连续三次失败后关闭应用
          AlertDialog.show({
            title: '登录失败',
            message: '连续3次密码错误，应用将自动关闭',
            autoCancel: false,
            alignment: DialogAlignment.Center,
            primaryButton: {
              value: '确定',
              action: () => {
                Logger.error(`Application terminated due to excessive login failures for ${this.username}`);
                this.context.terminateSelf();
              }
            }
          });
        } else {
          this.errorMessage = `用户名或密码错误，还剩${3 - failCount}次机会`;
        }
      }
    } catch (error) {
      Logger.error('Login process failed:', error as Error);
      this.errorMessage = '登录过程中发生错误，请稍后再试';
    } finally {
      this.loginLoading = false;
    }
  }

  build() {
    Stack() {

      // 内容卡片
      Column() {
        // Logo
        Image($r('app.media.zhihu'))
          .width(60)
          .height(60)
          .margin({ top: 40, bottom: 10 })
          .borderRadius(30)
          .backgroundColor('#ffffff')
          .shadow({ radius: 10, color: '#0084ff33', offsetX: 0, offsetY: 4 })

        Text('知乎账号登录')
          .fontSize(28)
          .fontWeight(FontWeight.Bold)
          .fontColor('#0084ff')
          .margin({ bottom: 30 })

        if (this.errorMessage) {
          Text(this.errorMessage)
            .fontSize(15)
            .fontColor('#ff4d4f')
            .margin({ bottom: 10 })
            .backgroundColor('#fff1f0')
            .borderRadius(8)
            .padding({ left: 10, right: 10, top: 4, bottom: 4 })
        }

        // 输入框
        TextInput({ placeholder: '用户名' })
          .width('90%')
          .height(48)
          .fontSize(18)
          .backgroundColor('#f5f6fa')
          .borderRadius(12)
          .margin({ bottom: 18 })
          .padding({ left: 16 })
          .onChange(value => this.username = value)

        TextInput({ placeholder: '密码' })
          .width('90%')
          .height(48)
          .type(InputType.Password)
          .fontSize(18)
          .backgroundColor('#f5f6fa')
          .borderRadius(12)
          .margin({ bottom: 18 })
          .padding({ left: 16 })
          .onChange(value => this.password = value)

        // 角色选择
        Row() {
          Text('角色：').fontSize(16).fontColor('#888').margin({ right: 10 })
          Radio({ value: 'user', group: 'role' })
            .checked(this.role === 'user')
            .onChange(checked => { if (checked) this.role = 'user' })
          Text('用户').fontSize(16).margin({ right: 20 })
          Radio({ value: 'admin', group: 'role' })
            .checked(this.role === 'admin')
            .onChange(checked => { if (checked) this.role = 'admin' })
          Text('管理员').fontSize(16)
        }
        .margin({ bottom: 30 })

        // 登录按钮
        Button('立即登录')
          .width('90%')
          .height(48)
          .fontSize(18)
          .fontWeight(FontWeight.Bold)
          .backgroundColor('#0084ff')
          .fontColor('#fff')
          .borderRadius(24)
          .shadow({ radius: 8, color: '#0084ff44', offsetX: 0, offsetY: 4 })
          .enabled(!this.loginLoading)
          .onClick(() => this.handleLogin())
          .margin({ bottom: 18 })

        // 注册引导
        Row() {
          Text('没有账号？').fontSize(15).fontColor('#888')
          Text('立即注册')
            .fontSize(15)
            .fontColor('#0084ff')
            .margin({ left: 8 })
            .onClick(async () => {
              await router.pushUrl({ url: 'pages/RegistrationPage' });
            })
        }
        .margin({ top: 10, bottom: 20 })

      }
      .width('92%')
      .backgroundColor('#fff')
      .borderRadius(18)
      .shadow({ radius: 16, color: '#0084ff22', offsetX: 0, offsetY: 8 })
      .alignItems(HorizontalAlign.Center)
      .margin({ top: 60, bottom: 40 })
      .padding({ top: 10, bottom: 30 })
    }
    .width('100%')
    .height('100%')
  }
}
```


### 2. Registration Page

#### 2.1 截图展示

<img src="注册页面.png" width="200" height="350">

注册失败（数据校验有误）时：
<img src="数据校验1.png" width="200" height="350">
<img src="数据校验2.png" width="200" height="350">

注册成功时：
<img src="注册成功.png" width="200" height="350">


#### 2.2 用例图与类图

<>Management Class Diagram
<img src="Registration Class Diagram.png" >
<img src="Registration Use Case Diagram.png" >
#### 2.3 代码实现

RegistrationPage.ets
```typescript
import { DatabaseHelper, UserData } from '../utils/DatabaseHelper';
import router from '@ohos.router';
import { Logger } from '../utils/Logger';
import common from '@ohos.app.ability.common';

/**
 * 注册页面组件
 * 实现新用户注册功能，包括：
 * 1. 必填信息验证：用户名、性别、邮箱、密码、角色
 * 2. 密码强度检测和提示
 * 3. 表单验证和错误提示
 * 4. 邮箱格式验证
 * 5. 角色选择（用户/管理员）
 * 6. 数据存储到SQLite数据库
 */
@Entry
@Component
struct RegistrationPage {
  // 用户注册表单的状态变量
  @State username: string = '';
  @State password: string = '';
  @State confirmPassword: string = '';
  @State email: string = '';
  @State gender: string = '男';
  @State role: string = 'user';
  // UI状态控制变量
  @State isLoading: boolean = false;
  @State showError: boolean = false;
  @State errorMessage: string = '';
  @State passwordStrength: number = 0; // 密码强度指示器：0-无, 1-弱, 2-中, 3-强

  // 组件初始化时调用
  aboutToAppear() {
    this.loadUserData();
  }

  // 初始化数据库连接
  async loadUserData() {
    try {
      const dbHelper = await DatabaseHelper.getInstance();
      const context = getContext(this) as common.Context;
      await dbHelper.init(context);
      Logger.log('Database initialized successfully');
    } catch (error) {
      Logger.error('Database initialization failed:', error);
      this.errorMessage = '系统初始化失败，请稍后重试';
      this.showError = true;
    }
  }

  // 按钮样式定义
  @Styles
  pressedStyles() {
    .opacity(0.8)
    .scale({ x: 0.95, y: 0.95 })
  }

  // 检查密码强度并返回强度级别
  private checkPasswordStrength(password: string): number {
    if (!password) return 0;

    let score = 0;
    // 检查长度
    if (password.length >= 8) score++;

    // 检查大写字母
    if (/[A-Z]/.test(password)) score++;

    // 检查小写字母
    if (/[a-z]/.test(password)) score++;

    // 检查数字
    if (/[0-9]/.test(password)) score++;

    // 返回强度级别 (0-4)
    return score;
  }

  // 获取密码要求提示信息
  private getPasswordTips(password: string): string[] {
    const tips: string[] = [];

    if (!password || password.length < 8) {
      tips.push('密码长度至少8位');
    }
    if (!/[A-Z]/.test(password)) {
      tips.push('需包含大写字母');
    }
    if (!/[a-z]/.test(password)) {
      tips.push('需包含小写字母');
    }
    if (!/[0-9]/.test(password)) {
      tips.push('需包含数字');
    }

    return tips;
  }

  // 验证表单所有字段
  private validateForm(): boolean {
    if (!this.username || !this.password || !this.confirmPassword || !this.email) {
      this.errorMessage = '请填写所有必填项';
      this.showError = true;
      return false;
    }

    if (this.password !== this.confirmPassword) {
      this.errorMessage = '两次输入的密码不一致';
      this.showError = true;
      return false;
    }

    const passwordTips = this.getPasswordTips(this.password);
    if (passwordTips.length > 0) {
      this.errorMessage = '密码不符合要求：' + passwordTips.join('，');
      this.showError = true;
      return false;
    }

    if (!/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/.test(this.email)) {
      this.errorMessage = '请输入有效的邮箱地址';
      this.showError = true;
      return false;
    }

    return true;
  }

  // 构建密码强度指示器UI组件
  @Builder
  PasswordStrengthIndicator() {
    Column() {
      Row() {
        Text('密码强度：')
          .fontSize(14)
          .fontColor('#666666')
        Row() {
          ForEach([1, 2, 3, 4], (level: number) => {
            Row()
              .width(40)
              .height(4)
              .backgroundColor(this.passwordStrength >= level ?
                (this.passwordStrength === 1 ? '#FF4D4F' :
                 this.passwordStrength === 2 ? '#FAAD14' :
                 this.passwordStrength === 3 ? '#52C41A' : '#1E88E5') : '#EBEDF0')
              .margin({ right: level !== 4 ? 4 : 0 })
          })
        }
        Text(this.passwordStrength === 0 ? '' :
             this.passwordStrength === 1 ? '弱' :
             this.passwordStrength === 2 ? '中' :
             this.passwordStrength === 3 ? '强' : '非常强')
          .fontSize(14)
          .fontColor(this.passwordStrength === 1 ? '#FF4D4F' :
                    this.passwordStrength === 2 ? '#FAAD14' :
                    this.passwordStrength === 3 ? '#52C41A' : '#1E88E5')
          .margin({ left: 8 })
      }
      .width('100%')
      .margin({ top: 8, bottom: 4 })

      if (this.password) {
        Column() {
          ForEach(this.getPasswordTips(this.password), (tip: string) => {
            Text('• ' + tip)
              .fontSize(12)
              .fontColor('#FF4D4F')
              .margin({ top: 4 })
              .alignSelf(ItemAlign.Start)
          })
        }
        .width('100%')
        .margin({ top: 8 })
      }
    }
  }

  // 构建页面主体UI
  build() {
    Column() {
      // 顶部标题栏
      Row() {
        Image($r('app.media.back'))
          .width(24)
          .height(24)
          .margin({ left: 16 })
          .onClick(() => {
            router.back();
          })
        Text('注册知乎账号')
          .fontSize(20)
          .fontWeight(FontWeight.Medium)
          .margin({ left: 16 })
      }
      .width('100%')
      .height(56)
      .backgroundColor('#FFFFFF')
      .shadow({ radius: 1, color: '#E8E8E8', offsetY: 2 })

      Scroll() {
        Column() {
          // Logo
          Image($r('app.media.zhihu'))
            .width(100)
            .height(100)
            .margin({ top: 20, bottom: 20 })

          // 注册表单
          Column() {
            if (this.showError) {
              Text(this.errorMessage)
                .fontSize(14)
                .fontColor('#FF4D4F')
                .margin({ bottom: 16 })
            }

            // 角色选择
            Row() {
              Text('选择角色：')
                .fontSize(16)
                .fontColor('#333333')
              Row({ space: 20 }) {
                Row() {
                  Radio({ value: 'user', group: 'role' })
                    .checked(this.role === 'user')
                    .onChange((isChecked: boolean) => {
                      if (isChecked) this.role = 'user';
                    })
                  Text('用户')
                    .fontSize(16)
                    .fontColor('#333333')
                    .margin({ left: 8 })
                }
                Row() {
                  Radio({ value: 'admin', group: 'role' })
                    .checked(this.role === 'admin')
                    .onChange((isChecked: boolean) => {
                      if (isChecked) this.role = 'admin';
                    })
                  Text('管理员')
                    .fontSize(16)
                    .fontColor('#333333')
                    .margin({ left: 8 })
                }
              }
            }
            .margin({ bottom: 16 })

            // 用户名输入框
            TextInput({ placeholder: '请输入用户名（2-15个字符）' })
              .maxLength(15)
              .type(InputType.Normal)
              .placeholderColor('#999999')
              .backgroundColor('#F6F6F6')
              .height(48)
              .borderRadius(8)
              .margin({ bottom: 16 })
              .onChange((value: string) => {
                this.username = value;
                this.showError = false;
              })

            // 密码输入框
            TextInput({ placeholder: '设置密码（至少12位，包含大小写字母、数字和特殊字符）' })
              .maxLength(20)
              .type(InputType.Password)
              .placeholderColor('#999999')
              .backgroundColor('#F6F6F6')
              .height(48)
              .borderRadius(8)
              .margin({ bottom: 8 })
              .onChange((value: string) => {
                this.password = value;
                this.showError = false;
                this.passwordStrength = this.checkPasswordStrength(value);
              })

            // 添加密码强度指示器
            this.PasswordStrengthIndicator()

            // 确认密码输入框
            TextInput({ placeholder: '请确认密码' })
              .maxLength(20)
              .type(InputType.Password)
              .placeholderColor('#999999')
              .backgroundColor('#F6F6F6')
              .height(48)
              .borderRadius(8)
              .margin({ bottom: 16 })
              .onChange((value: string) => {
                this.confirmPassword = value;
                this.showError = false;
              })

            // 邮箱输入框
            TextInput({ placeholder: '请输入邮箱' })
              .maxLength(50)
              .type(InputType.Email)
              .placeholderColor('#999999')
              .backgroundColor('#F6F6F6')
              .height(48)
              .borderRadius(8)
              .margin({ bottom: 16 })
              .onChange((value: string) => {
                this.email = value;
                this.showError = false;
              })

            // 性别选择
            Row() {
              Text('性别：')
                .fontSize(16)
                .fontColor('#333333')
              Row({ space: 20 }) {
                Row() {
                  Radio({ value: '男', group: 'gender' })
                    .checked(this.gender === '男')
                    .onChange((isChecked: boolean) => {
                      if (isChecked) this.gender = '男';
                    })
                  Text('男')
                    .fontSize(16)
                    .fontColor('#333333')
                    .margin({ left: 8 })
                }
                Row() {
                  Radio({ value: '女', group: 'gender' })
                    .checked(this.gender === '女')
                    .onChange((isChecked: boolean) => {
                      if (isChecked) this.gender = '女';
                    })
                  Text('女')
                    .fontSize(16)
                    .fontColor('#333333')
                    .margin({ left: 8 })
                }
              }
            }
            .margin({ bottom: 24 })

            // 注册按钮
            Button('注册', { type: ButtonType.Capsule })
              .width('100%')
              .height(48)
              .backgroundColor('#0066FF')
              .fontColor(Color.White)
              .fontSize(18)
              .enabled(!this.isLoading)
              .onClick(async () => {
                if (!this.validateForm()) {
                  return;
                }

                this.isLoading = true;
                try {
                  const dbHelper = await DatabaseHelper.getInstance();
                  const userData: UserData = new UserData(
                    this.username,
                    this.password,
                    this.email,
                    this.gender,
                    this.role
                  );

                  const success = await dbHelper.registerUser(userData);
                  if (success) {
                    AlertDialog.show({
                      title: '注册成功',
                      message: '欢迎加入知乎',
                      confirm: {
                        value: '确定',
                        action: () => {
                          router.back();
                        }
                      }
                    });
                  } else {
                    this.errorMessage = '注册失败，用户名可能已存在';
                    this.showError = true;
                  }
                } catch (error) {
                  Logger.error('Registration error:', error);
                  this.errorMessage = '注册失败，请稍后重试';
                  this.showError = true;
                } finally {
                  this.isLoading = false;
                }
              })

            // 已有账号链接
            Row() {
              Text('已有账号？')
                .fontSize(14)
                .fontColor('#666666')
              Text('立即登录')
                .fontSize(14)
                .fontColor('#0066FF')
                .margin({ left: 4 })
                .onClick(() => {
                  router.back();
                })
            }
            .margin({ top: 16 })
          }
          .width('90%')
          .padding(20)
          .backgroundColor(Color.White)
          .borderRadius(12)
          .shadow({ radius: 4, color: '#E8E8E8', offsetY: 2 })
        }
        .width('100%')
      }
      .layoutWeight(1)
      .backgroundColor('#F6F6F6')
    }
  }
}
```

### 3. Management Page

#### 3.1 截图展示
<img src="查询按钮.png" width="200" height="350">
<img src="编辑.png" width="200" height="350">
<img src="查询.png" width="200" height="350">
<img src="删除.png" width="200" height="350">




#### 3.2 用例图与类图
<img src="Management Use Case Diagram.png" >
<img src="Management Class Diagram.png" >

#### 3.3 代码实现

ManagementPage.ets
```typescript
import { DatabaseHelper, UserInfo } from '../utils/DatabaseHelper';
import router from '@ohos.router';
import { Logger } from '../utils/Logger';
import promptAction from '@ohos.promptAction';

/**
 * 管理页面
 * 功能：
 * 1. 管理员专用页面
 * 2. 查询并显示所有用户信息
 * 3. 用户信息解密显示
 * 4. 用户管理（删除、修改角色）
 */
@Entry
@Component
struct ManagementPage {
  // 用户列表相关状态变量
  @State private userList: UserInfo[] = [];  // 所有用户列表
  @State filteredUsers: UserInfo[] = [];     // 过滤后的用户列表
  @State loading: boolean = false;           // 加载状态
  @State refreshing: boolean = false;        // 刷新状态
  @State searchText: string = '';            // 搜索文本
  @State showUserList: boolean = false;      // 是否显示用户列表
  
  // 数据库操作相关变量
  private dbHelper: DatabaseHelper | null = null;
  private shouldQuery: boolean = false;

  // 页面初始化生命周期方法
  async aboutToAppear() {
    // 获取路由参数
    const params = router.getParams() as Record<string, string | boolean>;
    this.shouldQuery = params.shouldQuery as boolean;
    
    // 初始化数据库连接
    this.dbHelper = await DatabaseHelper.getInstance();
    await this.dbHelper.init(getContext(this));
    
    // 如果需要，立即查询用户列表
    if (this.shouldQuery) {
      await this.queryUsers();
    }
  }

  // 查询所有用户信息的方法
  async queryUsers() {
    try {
      this.loading = true;
      // 获取并解密用户列表
      const users = await this.dbHelper?.queryAllUsers();
      this.userList = users || [];
      this.filteredUsers = this.userList;
      this.showUserList = true;
      
      // 处理空列表情况
      if (this.userList.length === 0) {
        promptAction.showToast({ message: '暂无用户数据' });
      }
    } catch (error) {
      Logger.error('Query users failed:', error as Error);
      promptAction.showToast({ message: '查询用户失败' });
    } finally {
      this.loading = false;
    }
  }

  // 删除指定用户的方法
  async deleteUser(username: string) {
    try {
      const success = await this.dbHelper?.deleteUser(username);
      if (success) {
        promptAction.showToast({ message: '删除成功' });
        await this.queryUsers(); // 刷新列表
      } else {
        promptAction.showToast({ message: '删除失败，可能是管理员账号' });
      }
    } catch (error) {
      Logger.error('Delete user failed:', error as Error);
      promptAction.showToast({ message: '删除用户失败' });
    }
  }

  // 更新用户角色的方法
  async updateUserRole(username: string, newRole: string) {
    if (!this.dbHelper) {
      Logger.error('Database helper not initialized');
      return;
    }

    try {
      const result = await this.dbHelper.updateUserRole(username, newRole);
      if (result) {
        promptAction.showToast({ message: '角色更新成功' });
        await this.queryUsers();
      } else {
        promptAction.showToast({ message: '角色更新失败' });
      }
    } catch (error) {
      promptAction.showToast({ message: '角色更新失败：' + (error instanceof Error ? error.message : String(error)) });
    }
  }

  // 构建顶部导航栏UI组件
  @Builder TopBar() {
    Row() {
      Image($r('app.media.back'))
        .width(24)
        .height(24)
        .margin({ right: 16 })
        .onClick(() => {
          router.back();
        })

      Text('用户管理')
        .fontSize(20)
        .fontWeight(FontWeight.Bold)
    }
    .width('100%')
    .height(56)
    .padding({ left: 16, right: 16 })
    .backgroundColor('#FFFFFF')
  }

  // 构建搜索栏UI组件
  @Builder SearchBar() {
    Row() {
      Image($r('app.media.search'))
        .width(20)
        .height(20)
        .margin({ left: 12 })
        .fillColor('#999999')

      TextInput({ placeholder: '搜索用户' })
        .backgroundColor(Color.Transparent)
        .placeholderColor('#999999')
        .fontSize(16)
        .margin({ left: 8 })
        .layoutWeight(1)
        .onChange((value: string) => {
          this.searchText = value;
          this.filteredUsers = this.userList.filter(user =>
            user.username.toLowerCase().includes(value.toLowerCase()) ||
            user.email.toLowerCase().includes(value.toLowerCase())
          );
        })
    }
    .width('90%')
    .height(48)
    .margin({ top: 16, bottom: 16 })
    .padding({ left: 12, right: 12 })
    .backgroundColor('#F6F6F6')
    .borderRadius(24)
  }

  // 构建用户信息卡片UI组件
  @Builder UserCard(user: UserInfo) {
    Row() {
      Column() {
        Row() {
          Text(user.username)
            .fontSize(16)
            .fontWeight(FontWeight.Bold)
          Text(user.role)
            .fontSize(12)
            .fontColor('#1E88E5')
            .backgroundColor('#E3F2FD')
            .padding({ left: 8, right: 8, top: 2, bottom: 2 })
            .borderRadius(10)
            .margin({ left: 8 })
        }

        Row() {
          Text(user.email)
            .fontSize(14)
            .fontColor('#666666')
            .margin({ right: 16 })
          Text(user.gender)
            .fontSize(14)
            .fontColor('#666666')
        }
        .margin({ top: 4 })
      }
      .layoutWeight(1)
      .alignItems(HorizontalAlign.Start)

      Row() {
        Button({ type: ButtonType.Circle }) {
          Image($r('app.media.edit'))
            .width(20)
            .height(20)
        }
        .width(36)
        .height(36)
        .backgroundColor('#E3F2FD')
        .margin({ right: 8 })
        .onClick(() => {
          this.showRoleUpdateDialog(user);
        })

        if (user.role !== 'admin') {
          Button({ type: ButtonType.Circle }) {
            Image($r('app.media.delete'))
              .width(20)
              .height(20)
          }
          .width(36)
          .height(36)
          .backgroundColor('#FFF2F0')
          .onClick(() => {
            this.showDeleteConfirm(user);
          })
        }
      }
    }
    .width('100%')
    .padding(16)
    .backgroundColor('#FFFFFF')
    .borderRadius(12)
    .margin({ bottom: 12 })
  }

  // 显示角色更新对话框
  private showDeleteConfirm(user: UserInfo) {
    AlertDialog.show({
      title: '确认删除',
      message: `确定要删除用户 "${user.username}" 吗？此操作不可撤销。`,
      primaryButton: {
        value: '取消',
        action: () => {}
      },
      secondaryButton: {
        value: '删除',
        fontColor: '#FF4081',
        action: () => {
          this.deleteUser(user.username);
        }
      }
    });
  }

  private showRoleUpdateDialog(user: UserInfo) {
    AlertDialog.show({
      title: '更改用户角色',
      message: `当前用户：${user.username}\n当前角色：${user.role}`,
      primaryButton: {
        value: '取消',
        action: () => {}
      },
      secondaryButton: {
        value: user.role === 'admin' ? '取消管理员' : '设为管理员',
        fontColor: '#1E88E5',
        action: () => {
          const newRole = user.role === 'admin' ? 'user' : 'admin';
          this.updateUserRole(user.username, newRole);
        }
      }
    });
  }

  // 构建页面主体UI
  build() {
    Column() {
      this.TopBar()

      Column() {
        if (!this.showUserList) {
          Column() {
            Image($r('app.media.zhihu'))
              .width(120)
              .height(120)
              .margin({ bottom: 40 })

            Button('查询用户数据', { type: ButtonType.Capsule })
              .width(200)
              .height(50)
              .backgroundColor('#1E88E5')
              .fontColor(Color.White)
              .fontSize(18)
              .enabled(!this.loading)
              .onClick(() => {
                this.queryUsers();
              })
          }
          .width('100%')
          .layoutWeight(1)
          .justifyContent(FlexAlign.Center)
        } else {
          Column() {
            this.SearchBar()

            Refresh({ refreshing: $$this.refreshing }) {
              List() {
                ForEach(this.filteredUsers, (user: UserInfo) => {
                  ListItem() {
                    this.UserCard(user)
                  }
                })
              }
              .width('100%')
              .height('100%')
              .padding({ left: 16, right: 16 })
              .layoutWeight(1)
            }
            .onRefreshing(async () => {
              await this.queryUsers();
              this.refreshing = false;
              promptAction.showToast({ message: '刷新成功' });
            })

            if (this.filteredUsers.length === 0) {
              Column() {
                Image($r('app.media.zhihu'))
                  .width(120)
                  .height(120)
                  .margin({ bottom: 16 })
                Text(this.searchText ? '未找到相关用户' : '暂无用户数据')
                  .fontSize(16)
                  .fontColor('#999999')
              }
              .layoutWeight(1)
              .justifyContent(FlexAlign.Center)
            }

            Row() {
              Text(`共 ${this.userList.length} 位用户`)
                .fontSize(14)
                .fontColor('#666666')
            }
            .width('100%')
            .height(48)
            .justifyContent(FlexAlign.Center)
            .backgroundColor(Color.White)
          }
          .width('100%')
          .layoutWeight(1)
        }
      }
      .width('100%')
      .layoutWeight(1)
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }
}
```



### 4. Other Page
#### 4.1 补充截图
关键节点日志举例：<img src="日志.png" >
用户进入“知乎”首页<img src="homepage.png" >
#### 4.2 代码实现
DatabaseHelper.ets
```typescript
import { relationalStore } from "@kit.ArkData";
import { Logger } from './Logger';
import preferences from '@ohos.data.preferences';
import type common from '@ohos.app.ability.common';
import cryptoFramework from '@ohos.security.cryptoFramework';

// 用户数据模型类，包含完整的用户信息
export class UserData {
  username: string;
  password: string;
  email: string;
  gender: string;
  role: string;

  constructor(username: string = '', password: string = '', email: string = '', gender: string = '', role: string = '') {
    this.username = username;
    this.password = password;
    this.email = email;
    this.gender = gender;
    this.role = role;
  }
}

// 用户基本信息类，不包含敏感数据
export class UserInfo {
  username: string;
  gender: string;
  email: string;
  role: string;

  constructor(username: string = '', gender: string = '', email: string = '', role: string = '') {
    this.username = username;
    this.gender = gender;
    this.email = email;
    this.role = role;
  }
}

// 用户信息更新类，继承自UserInfo，可选包含新密码
export class UserUpdateInfo extends UserInfo {
  newPassword?: string;

  constructor(username: string = '', gender: string = '', email: string = '', role: string = '', newPassword?: string) {
    super(username, gender, email, role);
    this.newPassword = newPassword;
  }
}

// 数据库操作助手类，实现单例模式
export class DatabaseHelper {
  // 单例实例
  private static instance: DatabaseHelper;
  // 数据库存储实例
  private rdbStore: relationalStore.RdbStore | null = null;
  // 登录失败次数记录
  private loginFailCount: Map<string, number> = new Map<string, number>();
  // 应用上下文
  private context: common.Context | null = null;

  // 私有构造函数，确保单例模式
  private constructor() {
    this.context = null;
  }

  // 获取数据库助手实例
  public static async getInstance(): Promise<DatabaseHelper> {
    if (!DatabaseHelper.instance) {
      DatabaseHelper.instance = new DatabaseHelper();
    }
    return DatabaseHelper.instance;
  }

  // 初始化数据库，创建用户表
  public async init(context: common.Context): Promise<void> {
    this.context = context;
    const STORE_CONFIG: relationalStore.StoreConfig = {
      name: 'UserDB.db',
      securityLevel: relationalStore.SecurityLevel.S1,
    };

    const SQL_CREATE_TABLE = 'CREATE TABLE IF NOT EXISTS Users' +
      ' (' +
      'id INTEGER PRIMARY KEY AUTOINCREMENT,' +
      'username VARCHAR(255) UNIQUE,' +
      'gender VARCHAR(10),' +
      'email VARCHAR(255),' +
      'password VARCHAR(255),' +
      'role VARCHAR(20)' +
      ')';

    try {
      const store = await relationalStore.getRdbStore(context, STORE_CONFIG);
      this.rdbStore = store;
      await store.executeSql(SQL_CREATE_TABLE);
      Logger.log('Database initialized successfully');
    } catch (error) {
      Logger.error('Database initialization failed:', error as Error);
      throw new Error('Database initialization failed');
    }
  }

  // 密码加密方法，根据用户角色使用不同的加密策略
  private async encodePassword(password: string, role: string): Promise<string> {
    try {
      if (role === 'user') {
        // 使用HarmonyOS内置加密存储
        if (!this.context) {
          throw new Error('Context not initialized');
        }
        const pref = await preferences.getPreferences(this.context, 'user_passwords');
        // 使用preferences的加密存储能力
        await pref.put('pwd_' + password, password);
        await pref.flush();
        return 'SECURE_' + password;
      } else {
        // 管理员使用自定义加密
        const shifted = this.shiftEncrypt(password);
        return 'ADMIN_' + shifted;
      }
    } catch (error) {
      Logger.error('Password encryption failed:', error as Error);
      throw new Error('Password encryption failed');
    }
  }

  // 密码解密方法，根据用户角色使用不同的解密策略
  private async decodePassword(encodedPassword: string, role: string): Promise<string> {
    try {
      if (role === 'user') {
        if (!encodedPassword.startsWith('SECURE_')) {
          return encodedPassword; // 处理未加密的旧数据
        }
        if (!this.context) {
          throw new Error('Context not initialized');
        }
        const pref = await preferences.getPreferences(this.context, 'user_passwords');
        const originalPassword = encodedPassword.substring(7);
        const decryptedPassword = await pref.get('pwd_' + originalPassword, '') as string;
        return decryptedPassword;
      } else {
        if (!encodedPassword.startsWith('ADMIN_')) {
          return encodedPassword; // 处理未加密的旧数据
        }
        const encryptedPart = encodedPassword.substring(6);
        return this.shiftDecrypt(encryptedPart);
      }
    } catch (error) {
      Logger.error('Password decryption failed:', error as Error);
      throw new Error('Password decryption failed');
    }
  }

  // 简单的移位加密算法（用于管理员密码）
  private shiftEncrypt(text: string): string {
    return text.split('').map(char => {
      const code = char.charCodeAt(0);
      return String.fromCharCode(code + 1);
    }).join('');
  }

  // 移位解密算法（用于管理员密码）
  private shiftDecrypt(text: string): string {
    return text.split('').map(char => {
      const code = char.charCodeAt(0);
      return String.fromCharCode(code - 1);
    }).join('');
  }

  // 用户注册方法
  public async registerUser(userData: UserData): Promise<boolean> {
    if (!this.rdbStore) {
      throw new Error('Database not initialized');
    }

    try {
      const encryptedPassword: string = await this.encodePassword(userData.password, userData.role);
      const values: relationalStore.ValuesBucket = {
        username: userData.username,
        gender: userData.gender,
        email: userData.email,
        password: encryptedPassword,
        role: userData.role
      };

      await this.rdbStore.insert('Users', values);
      Logger.log(`User ${userData.username} registered successfully`);
      return true;
    } catch (error) {
      Logger.error('User registration failed:', error as Error);
      return false;
    }
  }

  // 验证用户登录
  public async verifyLogin(username: string, password: string, role: string): Promise<boolean> {
    if (!this.rdbStore) {
      throw new Error('Database not initialized');
    }

    try {
      const predicates = new relationalStore.RdbPredicates('Users');
      predicates.equalTo('username', username).and().equalTo('role', role);

      const resultSet = await this.rdbStore.query(predicates);
      if (resultSet.goToFirstRow()) {
        const storedPassword: string = resultSet.getString(resultSet.getColumnIndex('password'));
        const decodedStoredPassword = await this.decodePassword(storedPassword, role);
        resultSet.close();
        return decodedStoredPassword === password;
      }
      resultSet.close();
      return false;
    } catch (error) {
      Logger.error('Login verification failed:', error as Error);
      return false;
    }
  }

  public async queryAllUsers(): Promise<UserInfo[]> {
    if (!this.rdbStore) {
      throw new Error('Database not initialized');
    }

    try {
      const predicates = new relationalStore.RdbPredicates('Users');
      const resultSet = await this.rdbStore.query(predicates);
      const users: UserInfo[] = [];

      while (resultSet.goToNextRow()) {
        users.push(new UserInfo(
          resultSet.getString(resultSet.getColumnIndex('username')),
          resultSet.getString(resultSet.getColumnIndex('gender')),
          resultSet.getString(resultSet.getColumnIndex('email')),
          resultSet.getString(resultSet.getColumnIndex('role'))
        ));
      }

      resultSet.close();
      Logger.log('User list queried successfully');
      return users;
    } catch (error) {
      Logger.error('User list query failed:', error as Error);
      return [];
    }
  }

  public recordLoginFailure(username: string): number {
    const count: number = (this.loginFailCount.get(username) || 0) + 1;
    this.loginFailCount.set(username, count);
    Logger.log(`Login failure recorded for ${username}, count: ${count}`);
    return count;
  }

  public resetLoginFailure(username: string): void {
    this.loginFailCount.delete(username);
    Logger.log(`Login failure count reset for ${username}`);
  }

  public async deleteUser(username: string): Promise<boolean> {
    if (!this.rdbStore) {
      throw new Error('Database not initialized');
    }

    try {
      const predicates = new relationalStore.RdbPredicates('Users');
      predicates.equalTo('username', username).and().notEqualTo('role', 'admin');

      const result = await this.rdbStore.delete(predicates);
      Logger.log(`User ${username} deleted successfully`);
      return result > 0;
    } catch (error) {
      Logger.error('User deletion failed:', error as Error);
      return false;
    }
  }

  public async updateUserRole(username: string, newRole: string): Promise<boolean> {
    if (!this.rdbStore) {
      throw new Error('Database not initialized');
    }

    try {
      const values: relationalStore.ValuesBucket = {
        role: newRole
      };

      const predicates = new relationalStore.RdbPredicates('Users');
      predicates.equalTo('username', username);

      const result = await this.rdbStore.update(values, predicates);
      Logger.log(`User ${username} role updated to ${newRole}`);
      return result > 0;
    } catch (error) {
      Logger.error('User role update failed:', error as Error);
      return false;
    }
  }

  public async updateUser(username: string, updatedInfo: UserUpdateInfo): Promise<boolean> {
    if (!this.rdbStore) {
      throw new Error('Database not initialized');
    }

    try {
      const values: relationalStore.ValuesBucket = {
        email: updatedInfo.email,
        gender: updatedInfo.gender
      };

      if (updatedInfo.newPassword) {
        values.password = await this.encodePassword(updatedInfo.newPassword, updatedInfo.role);
      }
      
      const predicates = new relationalStore.RdbPredicates('Users');
      predicates.equalTo('username', username);
      
      const result = await this.rdbStore.update(values, predicates);
      Logger.log(`User ${username} information updated successfully`);
      return result > 0;
    } catch (error) {
      Logger.error('User update failed:', error as Error);
      return false;
    }
  }
}

```
loger.ets
```typescript
// 导入HarmonyOS日志工具包
import { hilog } from '@kit.PerformanceAnalysisKit';

// 日志工具类，提供统一的日志记录接口
export class Logger {
  // 日志域标识符和前缀
  private static readonly DOMAIN: number = 0x0001;
  private static readonly PREFIX: string = 'LoginSystem';

  // 记录普通信息日志
  public static log(message: string, ...args: string[]): void {
    hilog.info(Logger.DOMAIN, Logger.PREFIX, Logger.format(message, args));
  }

  // 记录错误信息日志
  public static error(message: string, error?: Error): void {
    if (error) {
      hilog.error(Logger.DOMAIN, Logger.PREFIX, `${message}: ${error.message}`);
    } else {
      hilog.error(Logger.DOMAIN, Logger.PREFIX, message);
    }
  }

  // 记录警告信息日志
  public static warn(message: string, ...args: string[]): void {
    hilog.warn(Logger.DOMAIN, Logger.PREFIX, Logger.format(message, args));
  }

  // 记录调试信息日志
  public static debug(message: string, ...args: string[]): void {
    hilog.debug(Logger.DOMAIN, Logger.PREFIX, Logger.format(message, args));
  }

  // 格式化日志消息
  private static format(message: string, args: string[]): string {
    if (!args || args.length === 0) return message;
    return message + ' ' + args.join(' ');
  }
} 
```
HomePage.ets
```typescript {.line-numbers}
import router from '@ohos.router';
import promptAction from '@ohos.promptAction';

// 推荐内容项的数据结构
interface RecommendItem {
  id: number;
  title: string;
  content: string;
  author: string;
  likes: number;
  comments: number;
}

// 热门话题的数据结构
interface HotTopic {
  id: number;
  title: string;
  heat: number;
}

@Entry
@Component
struct HomePage {
  // 页面状态变量
  @State username: string = '';
  @State activeTab: number = 0;
  @State refreshing: boolean = false;
  // Tab控制器
  private tabsController: TabsController = new TabsController();

  // 组件初始化时获取路由参数
  aboutToAppear() {
    const params = router.getParams() as Record<string, string>;
    this.username = params?.username || '用户';
  }

  // 模拟的推荐内容数据
  @State recommendList: RecommendItem[] = [
    {
      id: 1,
      title: '如何评价鸿蒙系统？',
      content: '鸿蒙系统作为华为自主研发的操作系统，在分布式能力、性能优化等方面都有显著提升...',
      author: '科技评论员',
      likes: 1234,
      comments: 256
    },
    {
      id: 2,
      title: '人工智能会取代人类工作吗？',
      content: 'AI的发展确实会改变就业市场，但更可能的是创造新的工作机会，而不是完全取代人类...',
      author: 'AI研究员',
      likes: 987,
      comments: 189
    },
    {
      id: 3,
      title: '如何提高编程效率？',
      content: '分享一些实用的编程技巧和工具，帮助你提高开发效率...',
      author: '资深程序员',
      likes: 567,
      comments: 89
    }
  ];

  // 模拟的热门话题数据
  @State hotTopics: HotTopic[] = [
    { id: 1, title: '#鸿蒙系统#', heat: 123456 },
    { id: 2, title: '#人工智能#', heat: 98765 },
    { id: 3, title: '#编程技巧#', heat: 56789 },
    { id: 4, title: '#科技前沿#', heat: 45678 }
  ];

  // 构建顶部导航栏UI
  @Builder TopBar() {
    Row() {
      Text('知乎')
        .fontSize(28)
        .fontWeight(FontWeight.Bold)
        .fontColor('#1E88E5')

      Row() {
        Button({ type: ButtonType.Circle, stateEffect: true }) {
          Image($r('app.media.search'))
            .width(24)
            .height(24)
        }
        .width(40)
        .height(40)
        .margin({ right: 8 })
        .backgroundColor('#F5F5F5')

        Button({ type: ButtonType.Circle, stateEffect: true }) {
          Badge({
            count: 5,
            position: BadgePosition.RightTop,
            style: { color: '#fff', fontSize: 12, badgeSize: 16, badgeColor: '#FF4081' }
          }) {
            Image($r('app.media.notification'))
              .width(24)
              .height(24)
          }
        }
        .width(40)
        .height(40)
        .backgroundColor('#F5F5F5')
      }
      .layoutWeight(1)
      .justifyContent(FlexAlign.End)
    }
    .width('100%')
    .height(56)
    .padding({ left: 16, right: 16 })
    .backgroundColor('#FFFFFF')
    .shadow({ radius: 8, color: '#1E88E508', offsetY: 2 })
  }

  // 构建用户信息卡片UI
  @Builder UserCard() {
    Row() {
      Row() {
        Image($r('app.media.zhihu'))
          .width(48)
          .height(48)
          .borderRadius(24)
          .margin({ right: 12 })

        Column() {
          Text(`欢迎回来，${this.username}`)
            .fontSize(18)
            .fontWeight(FontWeight.Bold)
            .margin({ bottom: 4 })
          Text('查看你的动态')
            .fontSize(14)
            .fontColor('#666666')
        }
        .alignItems(HorizontalAlign.Start)
      }

      Button('编辑资料', { type: ButtonType.Normal })
        .width(100)
        .height(36)
        .fontSize(14)
        .fontColor('#1E88E5')
        .backgroundColor('#E3F2FD')
        .borderRadius(18)
    }
    .width('100%')
    .padding(16)
    .backgroundColor('#FFFFFF')
    .borderRadius(12)
    .margin({ top: 12, bottom: 12 })
    .shadow({ radius: 12, color: '#1E88E508', offsetY: 4 })
  }

  // 构建推荐内容卡片UI
  @Builder RecommendCard(item: RecommendItem) {
    Column() {
      Text(item.title)
        .fontSize(18)
        .fontWeight(FontWeight.Bold)
        .margin({ bottom: 8 })

      Text(item.content)
        .fontSize(14)
        .margin({ bottom: 12 })
        .maxLines(2)
        .textOverflow({ overflow: TextOverflow.Ellipsis })
        .fontColor('#333333')

      Row() {
        Row() {
          Image($r('app.media.zhihu'))
            .width(20)
            .height(20)
            .borderRadius(10)
            .margin({ right: 8 })
          Text(item.author)
            .fontSize(14)
            .fontColor('#666666')
        }

        Row() {
          Button({ type: ButtonType.Circle }) {
            Row() {
              Image($r('app.media.like'))
                .width(16)
                .height(16)
                .margin({ right: 4 })
              Text(item.likes.toString())
                .fontSize(14)
                .fontColor('#666666')
            }
          }
          .backgroundColor('#F5F5F5')
          .height(32)
          .margin({ right: 12 })

          Button({ type: ButtonType.Circle }) {
            Row() {
              Image($r('app.media.comment'))
                .width(16)
                .height(16)
                .margin({ right: 4 })
              Text(item.comments.toString())
                .fontSize(14)
                .fontColor('#666666')
            }
          }
          .backgroundColor('#F5F5F5')
          .height(32)
        }
      }
      .width('100%')
      .justifyContent(FlexAlign.SpaceBetween)
    }
    .width('100%')
    .padding(16)
    .backgroundColor('#FFFFFF')
    .borderRadius(12)
    .margin({ bottom: 12 })
    .shadow({ radius: 12, color: '#1E88E508', offsetY: 4 })
  }

  // 构建热门话题卡片UI
  @Builder HotTopicCard(topic: HotTopic) {
    Row() {
      Text(topic.title)
        .fontSize(16)
        .fontWeight(FontWeight.Bold)
        .layoutWeight(1)

      Column() {
        Text(`${this.formatNumber(topic.heat)}`)
          .fontSize(16)
          .fontColor('#FF4081')
          .fontWeight(FontWeight.Bold)
        Text('热度')
          .fontSize(12)
          .fontColor('#999999')
      }
      .alignItems(HorizontalAlign.End)
    }
    .width('100%')
    .padding(16)
    .backgroundColor('#FFFFFF')
    .borderRadius(12)
    .margin({ bottom: 12 })
    .shadow({ radius: 12, color: '#1E88E508', offsetY: 4 })
  }

  // 格式化数字显示（将大数字转换为w格式）
  private formatNumber(num: number): string {
    if (num >= 10000) {
      return (num / 10000).toFixed(1) + 'w';
    }
    return num.toString();
  }

  // 构建页面主体UI
  build() {
    Column() {
      this.TopBar()

      Refresh({ refreshing: $$this.refreshing }) {
        Column() {
          this.UserCard()

          Tabs({ barPosition: BarPosition.Start, controller: this.tabsController }) {
            TabContent() {
              List() {
                ForEach(this.recommendList, (item: RecommendItem) => {
                  ListItem() {
                    this.RecommendCard(item)
                  }
                })
              }
              .width('100%')
              .height('100%')
              .padding({ left: 16, right: 16 })
            }
            .tabBar('推荐')
            .backgroundColor('#F5F5F5')

            TabContent() {
              List() {
                ForEach(this.hotTopics, (topic: HotTopic) => {
                  ListItem() {
                    this.HotTopicCard(topic)
                  }
                })
              }
              .width('100%')
              .height('100%')
              .padding({ left: 16, right: 16 })
            }
            .tabBar('热门')
            .backgroundColor('#F5F5F5')
          }
          .barMode(BarMode.Fixed)
          .barWidth('100%')
          .barHeight(48)
          .animationDuration(300)
          .onChange((index: number) => {
            this.activeTab = index;
          })
        }
        .width('100%')
      }
      .onRefreshing(() => {
        setTimeout(() => {
          this.refreshing = false;
          promptAction.showToast({ message: '刷新成功' });
        }, 1000);
      })
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }
}
```